{
    "name": "OCI registry pull-through cache to mirror rate-limited upstream registries, such as Docker Hub",
    "id": "pull-through-cache-registry",
    "version": "0.0.2",
    "description": "Deploys a devcontainer-local CNCF Distribution Registry configured as a pull-through cache for the local docker-in-docker",
    "documentationURL": "https://github.com/thediveo/devcontainer-features/blob/master/src/registry-pull-through-cache/README.md",
    "options": {
        "proxy-remote-url": {
            "type": "string",
            "default": "https://registry-1.docker.io",
            "description": "URL of the upstream OCI registry."
        },
        "port": {
            "type": "string",
            "default": "5000",
            "description": "port to bind the CNCF Distribution Registry service to.",
            "proposals": ["5000", "9999"]
        },
        "ttl": {
            "type": "string",
            "default": "168h",
            "description": "expire proxy cache storage after this duration, 168h corresponds with 7 days by default, set to 0 to disable any expiration. Valid duration suffixes are s, m, h, without suffix nanoseconds are assumed.",
            "proposals": ["24h", "168h"]
        },
        "registry-name": {
            "type": "string",
            "default": "registry-cache",
            "description": "the Docker container name to give the CNCF Distribution Registry."
        },
        "wait": {
            "type": "string",
            "default": "30",
            "description": "maximum wait time in seconds for Docker to become available when starting the CNCF Distribution Registry service."
        }
    },
    "mounts": [
        {
            "source": "ptcr-var-lib-registry-${devcontainerId}",
            "target": "/var/lib/registry",
            "type": "volume"
        }
    ],
    "postCreateCommand": "/usr/local/bin/registry-pull-through-cache",
    "dependsOn": {
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    }
}
